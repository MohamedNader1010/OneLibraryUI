"use strict";(self.webpackChunkOneLibraryUI=self.webpackChunkOneLibraryUI||[]).push([[970],{8970:(S,_,r)=>{r.r(_),r.d(_,{ServiceTypePerClientFormDialogComponent:()=>l});var s=r(4006),c=r(5412),e=r(4650),d=r(1809),g=r(7843),h=r(8653),v=r(7185),T=r(6895),f=r(5810),m=r(9549),C=r(4144),D=r(4859);function y(u,t){1&u&&(e.TgZ(0,"h2",14),e._uU(1,"\u062a\u0639\u062f\u064a\u0644 \u0633\u0639\u0631 \u0627\u0644\u062e\u062f\u0645\u0629"),e.qZA())}function I(u,t){1&u&&(e.TgZ(0,"h2",14),e._uU(1,"\u0623\u0636\u0627\u0641\u0629 \u0633\u0639\u0631 \u0627\u0644\u062e\u062f\u0645\u0629"),e.qZA())}function E(u,t){1&u&&(e.TgZ(0,"mat-error"),e._uU(1," \u064a\u062c\u0628 \u0627\u062f\u062e\u0627\u0644 \u0627\u0644\u0633\u0639\u0631 "),e.qZA())}class l{constructor(t,i,o,n,p,P,b){this.matDialogRef=t,this.data=i,this._servicePricePerClientType=o,this._service=n,this.fb=p,this._clientType=P,this.toastr=b,this.subscriptions=[],this.isSubmitting=!1,this.servicesDataSource=[],this.clientsTypeDataSource=[],this.onNoClick=()=>this.matDialogRef.close(),this.setServiceId=a=>this.serviceId.setValue(a),this.setClientTypeId=a=>this.clientTypeId.setValue(a),this.ngOnDestroy=()=>this.subscriptions.forEach(a=>a.unsubscribe()),this.form=p.group({id:[null],price:[0,[s.kI.required]],serviceId:[null,[s.kI.required]],clientTypeId:[null,[s.kI.required]]})}ngOnInit(){this.getAllClientTypes()}get id(){return this.form.get("id")}get price(){return this.form.get("price")}get serviceId(){return this.form.get("serviceId")}get clientTypeId(){return this.form.get("clientTypeId")}getAllClientTypes(){this.subscriptions.push(this._clientType.getAll().subscribe({next:t=>{this.clientsTypeDataSource=t.body},error:t=>{this.isSubmitting=!1,this.toastr.error((t.error??t).message)},complete:()=>{this.getAllServices()}}))}getAllServices(){this.subscriptions.push(this._service.getAll().subscribe({next:t=>{this.servicesDataSource=t.body},error:t=>{this.isSubmitting=!1,this.toastr.error((t.error??t).message)},complete:()=>{this.data&&this.form.patchValue(this.data)}}))}handleSubmit(){this.form.valid&&(this.id.value?this.update():this.add())}update(){this.subscriptions.push(this._servicePricePerClientType.update(this.id.value,this.form.value).subscribe({next:t=>{this.isSubmitting=!0,this._servicePricePerClientType.dialogData=t.body,this.matDialogRef.close({data:t})},error:t=>{this.isSubmitting=!1,this.toastr.error((t.error??t).message)},complete:()=>{this.isSubmitting=!1}}))}add(){this.subscriptions.push(this._servicePricePerClientType.add(this.form.value).subscribe({next:t=>{this.isSubmitting=!0,this._servicePricePerClientType.dialogData=t.body,this.matDialogRef.close({data:t})},error:t=>{this.isSubmitting=!1,this.toastr.error((t.error??t).message)},complete:()=>{this.isSubmitting=!1}}))}}l.\u0275fac=function(t){return new(t||l)(e.Y36(c.so),e.Y36(c.WI),e.Y36(d.c),e.Y36(g.r),e.Y36(s.qu),e.Y36(h.q),e.Y36(v._W))},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-service-type-per-client-form-dialog"]],decls:21,vars:10,consts:[[1,"container"],["class","w-100 text-center mt-3",4,"ngIf","ngIfElse"],["update",""],[1,"d-flex","flex-column","w-100",3,"formGroup","ngSubmit"],[1,"row"],["label","\u0627\u0644\u062e\u062f\u0645\u0627\u062a",1,"col-6",3,"dataSource","selectedValue","selectedId"],["label","\u0646\u0648\u0639 \u0627\u0644\u0639\u0645\u064a\u0644",1,"col-6",3,"dataSource","selectedValue","selectedId"],[1,"col"],["color","warn",1,"w-100"],["type","number","matInput","","formControlName","price","min","0"],[4,"ngIf"],[1,"my-2","d-flex","flex-row-reverse"],["mat-raised-button","","type","submit","color","warn",1,"mx-2","px-4",3,"disabled"],["type","button","mat-stroked-button","","color","warn","tabindex","-1",3,"click"],[1,"w-100","text-center","mt-3"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e.YNc(1,y,2,0,"h2",1),e.YNc(2,I,2,0,"ng-template",null,2,e.W1O),e.TgZ(4,"mat-dialog-content")(5,"form",3),e.NdJ("ngSubmit",function(){return i.handleSubmit()}),e.TgZ(6,"div",4)(7,"autocomplete",5),e.NdJ("selectedId",function(n){return i.setServiceId(n)}),e.qZA(),e.TgZ(8,"autocomplete",6),e.NdJ("selectedId",function(n){return i.setClientTypeId(n)}),e.qZA()(),e.TgZ(9,"div",4)(10,"div",7)(11,"mat-form-field",8)(12,"mat-label"),e._uU(13,"\u0627\u0644\u0633\u0639\u0631"),e.qZA(),e._UZ(14,"input",9),e.YNc(15,E,2,0,"mat-error",10),e.qZA()()(),e.TgZ(16,"div",11)(17,"button",12),e._uU(18),e.qZA(),e.TgZ(19,"button",13),e.NdJ("click",function(){return i.onNoClick()}),e._uU(20,"\u0625\u0644\u063a\u0627\u0621"),e.qZA()()()()()),2&t){const o=e.MAs(3);e.xp6(1),e.Q6J("ngIf",i.data)("ngIfElse",o),e.xp6(4),e.Q6J("formGroup",i.form),e.xp6(2),e.Q6J("dataSource",i.servicesDataSource)("selectedValue",i.serviceId.value),e.xp6(1),e.Q6J("dataSource",i.clientsTypeDataSource)("selectedValue",i.clientTypeId.value),e.xp6(7),e.Q6J("ngIf",i.price.hasError("required")&&(i.price.touched||i.price.dirty)),e.xp6(2),e.Q6J("disabled",!i.form.valid||i.isSubmitting),e.xp6(1),e.Oqu(i.isSubmitting?"\u0627\u0646\u062a\u0638\u0631 \u0645\u0646 \u0641\u0636\u0644\u0643":"\u062d\u0641\u0638")}},dependencies:[s._Y,s.Fj,s.wV,s.JJ,s.JL,s.qQ,s.sg,s.u,T.O5,f.Y,c.xY,m.KE,m.hX,m.TO,C.Nt,D.lW]})}}]);