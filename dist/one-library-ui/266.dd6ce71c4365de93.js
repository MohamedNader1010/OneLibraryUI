"use strict";(self.webpackChunkOneLibraryUI=self.webpackChunkOneLibraryUI||[]).push([[266],{1266:(F,m,a)=>{a.r(m),a.d(m,{TransactionComponent:()=>s});var i=a(4006),l=a(5412),c=a(4004);function f(u,r){return e=>u.GetById(r).pipe((0,c.U)(n=>n.body.rest<e.value?{exceed:!0,value:n.body.rest}:null))}var t=a(4650),p=a(9198),g=a(7185),h=a(1390),v=a(6895),d=a(9549),b=a(4144),Z=a(4859),y=a(9383);function T(u,r){1&u&&(t.TgZ(0,"mat-error"),t._uU(1,"\u0627\u0644\u0645\u0628\u0644\u063a \u0627\u0644\u0645\u062f\u0641\u0648\u0639 \u0645\u0637\u0644\u0648\u0628"),t.qZA())}function A(u,r){if(1&u&&(t.TgZ(0,"mat-error"),t._uU(1),t.qZA()),2&u){const e=t.oxw();t.xp6(1),t.hij(" \u0627\u0644\u0645\u0628\u0644\u063a \u0627\u0644\u0645\u062f\u0641\u0648\u0639 < \u0627\u0648 = ",null==e.paid.errors?null:e.paid.errors.value," ")}}class s{constructor(r,e,n,o,C,x,I){this.dialogRef=r,this.data=e,this._order=n,this.toastr=o,this.route=C,this.dialog=x,this.fb=I,this.subscriptions=[],this.isSubmitting=!1,this.ngOnDestroy=()=>this.subscriptions.forEach(U=>U.unsubscribe()),this.Form=this.fb.group({id:[0],orderId:[0,[i.kI.required]],paid:[null,[i.kI.required],[f(this._order,this.data.id)]],previousPaid:[e.paid],rest:[e.rest]}),this.data&&(this.orderId.setValue(this.data.id),this.onPaidControlChange())}get id(){return this.Form.get("id")}get orderId(){return this.Form.get("orderId")}get paid(){return this.Form.get("paid")}get rest(){return this.Form.get("rest")}onPaidControlChange(){this.paid.valueChanges.subscribe(r=>{this.rest.setValue(+this.data.rest-r)})}onNoClick(){this.dialogRef.close()}handleSubmit(){this.Form.valid&&(this.isSubmitting=!0,this.add())}add(){this.subscriptions.push(this._order.addOrderTransaction(this.Form.value).subscribe({next:r=>{this._order.dialogData=r.body,this.dialogRef.close({data:r})},error:r=>{this.isSubmitting=!1,this.toastr.error((r.error??r).message)},complete:()=>{this.isSubmitting=!1}}))}}s.\u0275fac=function(r){return new(r||s)(t.Y36(l.so),t.Y36(l.WI),t.Y36(p.p),t.Y36(g._W),t.Y36(h.gz),t.Y36(l.uw),t.Y36(i.qu))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-transaction"]],decls:35,vars:15,consts:[[1,"container"],[1,"w-100","text-center","mt-3"],[1,"d-flex","flex-column",3,"formGroup","ngSubmit"],[1,"row"],["appearance","fill","color","warn",1,"w-100"],["type","text","matInput","","formControlName","orderId","readonly",""],["appearance","fill","color","warn",1,"col-6"],["id","rest","matInput","","type","number","formControlName","rest","readonly","true"],["id","previousPaid","matInput","","type","number","formControlName","previousPaid","readonly","true"],["id","paid","matInput","","type","number","formControlName","paid"],[4,"ngIf"],[1,"my-2","d-flex","flex-row-reverse"],["mat-raised-button","","color","warn",1,"mx-2","px-4",3,"disabled"],["type","button","mat-stroked-button","","color","warn",3,"click"]],template:function(r,e){1&r&&(t.TgZ(0,"div",0)(1,"h2",1),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"mat-dialog-content")(5,"form",2),t.NdJ("ngSubmit",function(){return e.handleSubmit()}),t.TgZ(6,"div",3)(7,"mat-form-field",4)(8,"mat-label"),t._uU(9,"\u0631\u0642\u0645 \u0627\u0644\u0637\u0644\u0628"),t.qZA(),t._UZ(10,"input",5),t.qZA()(),t.TgZ(11,"div",3)(12,"mat-form-field",6)(13,"mat-label"),t._uU(14,"\u0627\u0644\u0645\u062a\u0628\u0642\u064a"),t.qZA(),t._UZ(15,"input",7),t.qZA(),t.TgZ(16,"mat-form-field",6)(17,"mat-label"),t._uU(18,"\u0627\u0644\u0645\u062f\u0641\u0648\u0639 \u0645\u0633\u0628\u0642\u0627"),t.qZA(),t._UZ(19,"input",8),t.qZA()(),t.TgZ(20,"div",3)(21,"mat-form-field",4)(22,"mat-label"),t._uU(23,"\u0627\u0644\u0645\u062f\u0641\u0648\u0639 \u062d\u0627\u0644\u064a\u0627"),t.qZA(),t._UZ(24,"input",9),t.YNc(25,T,2,0,"mat-error",10),t.YNc(26,A,2,1,"mat-error",10),t.qZA()(),t.TgZ(27,"div",11)(28,"button",12),t._uU(29),t.ALo(30,"translate"),t.ALo(31,"translate"),t.qZA(),t.TgZ(32,"button",13),t.NdJ("click",function(){return e.onNoClick()}),t._uU(33),t.ALo(34,"translate"),t.qZA()()()()()),2&r&&(t.xp6(2),t.Oqu(t.lcZ(3,7,"order.transaction")),t.xp6(3),t.Q6J("formGroup",e.Form),t.xp6(20),t.Q6J("ngIf",null==e.paid.errors?null:e.paid.errors.required),t.xp6(1),t.Q6J("ngIf",e.paid.hasError("exceed")),t.xp6(2),t.Q6J("disabled",!e.Form.valid||e.isSubmitting),t.xp6(1),t.Oqu(e.isSubmitting?t.lcZ(30,9,"button.wait"):t.lcZ(31,11,"button.save")),t.xp6(4),t.Oqu(t.lcZ(34,13,"button.back")))},dependencies:[i._Y,i.Fj,i.wV,i.JJ,i.JL,i.sg,i.u,v.O5,l.xY,d.KE,d.hX,d.TO,b.Nt,Z.lW,y.X$],styles:["mat-card[_ngcontent-%COMP%]{width:20%}[_nghost-%COMP%]{height:100%;display:flex;justify-content:center;vertical-align:middle;align-items:center}  datepicker-value-example .mat-form-field-label{color:#f84bb3}  .mat-datepicker-toggle{color:#fad}  .mat-form-field-underline{color:#fad}"]})}}]);