"use strict";(self.webpackChunkOneLibraryUI=self.webpackChunkOneLibraryUI||[]).push([[420],{8420:(O,v,s)=>{s.r(v),s.d(v,{AuthModule:()=>h});var A=s(6895),u=s(4006),y=s(8019),t=s(4650),a=s(1390),T=s(3175);class l{constructor(r,e){this._router=r,this.jwtHelper=e}canActivateChild(){return this.Auth()}canActivate(){return this.Auth()}canLoad(){return this.Auth()}Auth(){return!localStorage.getItem("refreshToken")||(this._router.navigate([""]),!1)}}l.\u0275fac=function(r){return new(r||l)(t.LFG(a.F0),t.LFG(T.N0))},l.\u0275prov=t.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"});var w=s(2746),b=s(7185);class c{constructor(r,e,n,p){this._auth=r,this.route=e,this.toastr=n,this.router=p,this.subscriptions=[],this.ngOnDestroy=()=>this.subscriptions.forEach(C=>C.unsubscribe())}ngOnInit(){this.subscriptions.push(this.route.queryParams.subscribe(r=>{this.subscriptions.push(this._auth.confirmEmail(r.userid,r.token).subscribe({next:e=>{let n=e.body;this._auth.setLocalStorage(n),this._auth.username.next(n.username),this._auth.isLogged=!0,this.toastr.success(e.message,"logged in")},error:e=>{this._auth.isLogged=!1,this._auth.username.next(null),this._auth.clearLocalStorage(),this.toastr.error((e.error??e).message,"unauthorized")},complete:()=>{this.router.navigate([""])}}))}))}}c.\u0275fac=function(r){return new(r||c)(t.Y36(w.e),t.Y36(a.gz),t.Y36(b._W),t.Y36(a.F0))},c.\u0275cmp=t.Xpm({type:c,selectors:[["app-confirm-email"]],decls:0,vars:0,template:function(r,e){}});var m=s(9549),Z=s(4144),i=s(3546),P=s(4859);function _(o,r){1&o&&(t.TgZ(0,"mat-error"),t._uU(1,"\u064a\u062c\u0628 \u0627\u062f\u062e\u0627\u0644 \u0627\u0644\u0628\u0631\u064a\u062f \u0627\u0644\u0627\u0644\u0643\u062a\u0631\u0648\u0646\u064a"),t.qZA())}class g{constructor(r,e,n,p){this.router=r,this._login=e,this.fb=n,this.toastr=p,this.hide=!0,this.logging=!1,this.form=this.fb.group({email:["",[u.kI.required,u.kI.email,u.kI.pattern("^.+@.+..+$")]]})}get email(){return this.form.get("email")}handleLogin(){this.router.navigate(["auth/login"])}handleSubmit(){this.form.valid&&(this.logging=!0,this._login.forgetPassword(this.email.value).subscribe({next:r=>{this.toastr.success(r.message,"check your email")},error:r=>{this.logging=!1,this.toastr.error((r.error??r).message)},complete:()=>{this.logging=!1,this.router.navigate([""])}}))}}g.\u0275fac=function(r){return new(r||g)(t.Y36(a.F0),t.Y36(w.e),t.Y36(u.qu),t.Y36(b._W))},g.\u0275cmp=t.Xpm({type:g,selectors:[["app-forget-password"]],decls:18,vars:4,consts:[[1,"shadow-lg",2,"width","450px","border","1px solid #dadce0"],[3,"formGroup","ngSubmit"],[1,"mb-3"],["appearance","outline","color","warn",1,"w-100"],["type","text","matInput","","formControlName","email"],[4,"ngIf"],["align","end",1,"justify-content-between"],["mat-raised-button","","color","warn",3,"disabled"],["type","button","mat-stroked-button","","color","warn",1,"mx-2",3,"click"]],template:function(r,e){1&r&&(t.TgZ(0,"mat-card",0)(1,"form",1),t.NdJ("ngSubmit",function(){return e.handleSubmit()}),t.TgZ(2,"mat-card-header")(3,"mat-card-title",2),t._uU(4,"\u0646\u0633\u064a\u062a \u0643\u0644\u0645\u0629 \u0627\u0644\u0633\u0631"),t.qZA()(),t.TgZ(5,"mat-card-content")(6,"p"),t._uU(7,"\u0644\u0627 \u062a\u0642\u0644\u0642! \u0641\u0642\u0637 \u0627\u062f\u062e\u0644 \u0628\u0631\u064a\u062f\u0643 \u0627\u0644\u0627\u0644\u0643\u062a\u0631\u0648\u0646\u064a"),t.qZA(),t.TgZ(8,"mat-form-field",3)(9,"mat-label"),t._uU(10,"Email"),t.qZA(),t._UZ(11,"input",4),t.YNc(12,_,2,0,"mat-error",5),t.qZA()(),t.TgZ(13,"mat-card-actions",6)(14,"button",7),t._uU(15),t.qZA(),t.TgZ(16,"button",8),t.NdJ("click",function(){return e.handleLogin()}),t._uU(17,"\u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u062f\u062e\u0648\u0644"),t.qZA()()()()),2&r&&(t.xp6(1),t.Q6J("formGroup",e.form),t.xp6(11),t.Q6J("ngIf",null==e.email.errors?null:e.email.errors.required),t.xp6(2),t.Q6J("disabled",!e.form.valid||e.logging),t.xp6(1),t.Oqu(e.logging?"\u0627\u0646\u062a\u0638\u0631 \u0645\u0646 \u0641\u0636\u0644\u0643":"\u0625\u0631\u0633\u0627\u0644"))},dependencies:[A.O5,m.KE,m.hX,m.TO,Z.Nt,i.a8,i.hq,i.dn,i.dk,i.n5,P.lW,u._Y,u.Fj,u.JJ,u.JL,u.sg,u.u],styles:["mat-card[_ngcontent-%COMP%]{width:20%}[_nghost-%COMP%]{height:100%;display:flex;justify-content:center;vertical-align:middle;align-items:center}"]});var F=s(532),I=s(1633),k=s(7392);function J(o,r){if(1&o&&(t.TgZ(0,"mat-error"),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij(" \u0643\u0644\u0645\u0629 \u0627\u0644\u0633\u0631 \u064a\u062c\u0628 \u0627\u0644\u0627 \u062a\u0642\u0644 \u0639\u0646 ",null==e.newPassword.errors||null==e.newPassword.errors.minlength?null:e.newPassword.errors.minlength.requiredLength," \u0631\u0645\u0632 ")}}function L(o,r){1&o&&(t.TgZ(0,"mat-error"),t._uU(1," \u064a\u062c\u0628 \u0627\u062f\u062e\u0627\u0644 \u0643\u0644\u0645\u0629 \u0627\u0644\u0633\u0631 "),t.qZA())}function U(o,r){1&o&&(t.TgZ(0,"mat-error"),t._uU(1," \u064a\u062c\u0628 \u062a\u0627\u0643\u064a\u062f \u0643\u0644\u0645\u0629 \u0627\u0644\u0633\u0631 "),t.qZA())}class f{constructor(r,e,n,p,C){this.route=r,this.router=e,this._login=n,this.fb=p,this.toastr=C,this.subscriptions=[],this.hide=!0,this.hideConfirm=!0,this.logging=!1,this.ngOnDestroy=()=>this.subscriptions.forEach(Y=>Y.unsubscribe()),this.form=this.fb.group({newPassword:["",[u.kI.required,u.kI.minLength(6),u.kI.maxLength(100)]],confirmPassword:["",[u.kI.required,u.kI.maxLength(100)]],email:[null],token:[null]},{validators:I.d.MatchValidator("newPassword","confirmPassword")})}get confirmPassword(){return this.form.get("confirmPassword")}get newPassword(){return this.form.get("newPassword")}get email(){return this.form.get("email")}get token(){return this.form.get("token")}ngOnInit(){this.subscriptions.push(this.route.queryParams.subscribe(r=>{this.email.setValue(r.email),this.token.setValue(r.token)}))}handleLogin(){this.router.navigate(["auth/login"])}handleSubmit(){this.form.valid&&(this.logging=!0,this._login.resetPassword(this.form.value).subscribe({next:r=>{this._login.clearLocalStorage(),this.toastr.success(r.message,"logged in sucessfully")},error:r=>{this.logging=!1,this.toastr.error((r.error??r).message)},complete:()=>{this.logging=!1,this.router.navigate(["auth/login"])}}))}}f.\u0275fac=function(r){return new(r||f)(t.Y36(a.gz),t.Y36(a.F0),t.Y36(w.e),t.Y36(u.qu),t.Y36(b._W))},f.\u0275cmp=t.Xpm({type:f,selectors:[["app-reset-password"]],decls:28,vars:14,consts:[[1,"shadow-lg",2,"width","450px","border","1px solid #dadce0"],[3,"formGroup","ngSubmit"],[1,"mb-3"],["appearance","fill","color","warn",1,"w-100"],["matInput","","autocomplete","new-password","formControlName","newPassword",3,"type"],["type","button","mat-icon-button","","matSuffix","",3,"click"],[4,"ngIf"],["matInput","","autocomplete","new-password","formControlName","confirmPassword",3,"type"],["align","end",1,"justify-content-between"],["mat-raised-button","","color","warn",3,"disabled"],["type","button","mat-stroked-button","","color","warn",1,"mx-2",3,"click"]],template:function(r,e){1&r&&(t.TgZ(0,"mat-card",0)(1,"form",1),t.NdJ("ngSubmit",function(){return e.handleSubmit()}),t.TgZ(2,"mat-card-header")(3,"mat-card-title",2),t._uU(4,"\u062a\u063a\u064a\u064a\u0631 \u0643\u0644\u0645\u0629 \u0627\u0644\u0633\u0631"),t.qZA()(),t.TgZ(5,"mat-card-content")(6,"mat-form-field",3)(7,"mat-label"),t._uU(8,"\u0643\u0644\u0645\u0629 \u0627\u0644\u0633\u0631"),t.qZA(),t._UZ(9,"input",4),t.TgZ(10,"button",5),t.NdJ("click",function(){return e.hide=!e.hide}),t.TgZ(11,"mat-icon"),t._uU(12),t.qZA()(),t.YNc(13,J,2,1,"mat-error",6),t.YNc(14,L,2,0,"mat-error",6),t.qZA(),t.TgZ(15,"mat-form-field",3)(16,"mat-label"),t._uU(17,"\u062a\u0627\u0643\u064a\u062f \u0643\u0644\u0645\u0629 \u0627\u0644\u0633\u0631"),t.qZA(),t._UZ(18,"input",7),t.TgZ(19,"button",5),t.NdJ("click",function(){return e.hideConfirm=!e.hideConfirm}),t.TgZ(20,"mat-icon"),t._uU(21),t.qZA()(),t.YNc(22,U,2,0,"mat-error",6),t.qZA()(),t.TgZ(23,"mat-card-actions",8)(24,"button",9),t._uU(25),t.qZA(),t.TgZ(26,"button",10),t.NdJ("click",function(){return e.handleLogin()}),t._uU(27,"\u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u062f\u062e\u0648\u0644"),t.qZA()()()()),2&r&&(t.xp6(1),t.Q6J("formGroup",e.form),t.xp6(8),t.Q6J("type",e.hide?"password":"text"),t.xp6(1),t.uIk("aria-label","Hide password")("aria-pressed",e.hide),t.xp6(2),t.Oqu(e.hide?"visibility_off":"visibility"),t.xp6(1),t.Q6J("ngIf",(null==e.newPassword.errors?null:e.newPassword.errors.minlength)&&!(null!=e.newPassword.errors&&e.newPassword.errors.required)),t.xp6(1),t.Q6J("ngIf",null==e.newPassword.errors?null:e.newPassword.errors.required),t.xp6(4),t.Q6J("type",e.hideConfirm?"password":"text"),t.xp6(1),t.uIk("aria-label","Hide confirm password")("aria-pressed",e.hideConfirm),t.xp6(2),t.Oqu(e.hideConfirm?"visibility_off":"visibility"),t.xp6(1),t.Q6J("ngIf",null==e.confirmPassword.errors?null:e.confirmPassword.errors.required),t.xp6(2),t.Q6J("disabled",!e.form.valid||e.logging),t.xp6(1),t.Oqu(e.logging?"\u0627\u0646\u062a\u0638\u0631 \u0645\u0646 \u0641\u0636\u0644\u0643":"\u062d\u0641\u0638"))},dependencies:[A.O5,m.KE,m.hX,m.TO,m.R9,k.Hw,Z.Nt,i.a8,i.hq,i.dn,i.dk,i.n5,P.lW,P.RK,u._Y,u.Fj,u.JJ,u.JL,u.sg,u.u],styles:["mat-card[_ngcontent-%COMP%]{width:20%}[_nghost-%COMP%]{height:100%;display:flex;justify-content:center;vertical-align:middle;align-items:center}"]});const q=[{path:"login",component:F.G,title:"\u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u062f\u062e\u0648\u0644",canActivate:[l]},{path:"confirmEmail",component:c,title:"\u062a\u0627\u0643\u064a\u062f \u0627\u0644\u0628\u0631\u064a\u062f \u0627\u0644\u0627\u0644\u0643\u062a\u0631\u0648\u0646\u064a"},{path:"resetPassword",component:f,title:"\u0625\u0639\u062f\u0627\u062f \u0627\u0644\u0631\u0642\u0645 \u0627\u0644\u0633\u0631\u064a"},{path:"forgetPassword",component:g,title:"\u0646\u0633\u064a\u062a \u0627\u0644\u0631\u0642\u0645 \u0627\u0644\u0633\u0631\u064a"},{path:"auth",redirectTo:"login",pathMatch:"full"},{path:"",redirectTo:"/",pathMatch:"full"}];class d{}d.\u0275fac=function(r){return new(r||d)},d.\u0275mod=t.oAB({type:d}),d.\u0275inj=t.cJS({imports:[a.Bz.forChild(q),a.Bz]});class h{}h.\u0275fac=function(r){return new(r||h)},h.\u0275mod=t.oAB({type:h}),h.\u0275inj=t.cJS({providers:[w.e,l],imports:[A.ez,d,y.I,u.u5,u.UX]})}}]);