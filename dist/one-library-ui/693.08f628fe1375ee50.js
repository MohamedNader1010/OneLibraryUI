"use strict";(self.webpackChunkOneLibraryUI=self.webpackChunkOneLibraryUI||[]).push([[693],{9693:(ot,_,n)=>{n.r(_),n.d(_,{materialTrackingModule:()=>f});var m=n(6895),s=n(4006),S=n(6578),F=n(1697),N=n(7110),T=n(1390),U=n(7974),Z=n(6308),k=n(4968),Y=n(5249),d=(()=>{return(i=d||(d={}))[i.\u0648\u0627\u0631\u062f=0]="\u0648\u0627\u0631\u062f",i[i.\u0635\u0627\u062f\u0631=1]="\u0635\u0627\u062f\u0631",d;var i})(),u=n(5412),t=n(4650),M=n(1135),I=n(2703),O=n(529),D=n(7185);class c extends I.M{constructor(e,a){super(e,"MaterialIncomeOutcome"),this.toastr=a,this.loadingData=new M.X(!1),this.dataChange=new M.X([])}get loading(){return this.loadingData.value}get data(){return this.dataChange.value??[]}get DialogData(){return this.dialogData}getAllMaterialTracking(){this.http.get(this.uri).subscribe({next:e=>{this.loadingData.next(!0),this.dataChange.next(e.body)},error:e=>{this.loadingData.next(!1),this.toastr.error((e.error??e).message)},complete:()=>this.loadingData.next(!1)})}}c.\u0275fac=function(e){return new(e||c)(t.LFG(O.eN),t.LFG(D._W))},c.\u0275prov=t.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"});var y=n(4859);class b{constructor(e,a,o,l){this.dialogRef=e,this.data=a,this._mat=o,this.toastr=l,this.isSubmitting=!1}onNoClick(){this.dialogRef.close()}confirmDelete(){this._mat.delete(this.data.id).subscribe({next:e=>{this.isSubmitting=!0,this.dialogRef.close({data:e})},error:e=>{this.toastr.error((e.error??e).message)},complete:()=>{this.isSubmitting=!1}})}}b.\u0275fac=function(e){return new(e||b)(t.Y36(u.so),t.Y36(u.WI),t.Y36(c),t.Y36(D._W))},b.\u0275cmp=t.Xpm({type:b,selectors:[["app-delete",8,"dialog"]],attrs:["class","dialog"],decls:29,vars:6,consts:[[1,"container"],["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","tabindex","-1",3,"click"]],template:function(e,a){1&e&&(t.TgZ(0,"div",0)(1,"h3",1),t._uU(2,"\u0633\u064a\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u062a\u0627\u0644\u064a\u0629 , \u0647\u0644 \u0627\u0646\u062a \u0645\u062a\u0623\u0643\u062f\u061f"),t.qZA(),t.TgZ(3,"div",2)(4,"h4")(5,"strong"),t._uU(6,"Id:"),t.qZA(),t._uU(7),t.qZA(),t.TgZ(8,"h4")(9,"strong"),t._uU(10,"\u0627\u0644\u062e\u0627\u0645\u0629 : "),t.qZA(),t._uU(11),t.qZA(),t.TgZ(12,"h4")(13,"strong"),t._uU(14,"\u0627\u0644\u062d\u0627\u0644\u0629 : "),t.qZA(),t._uU(15),t.qZA(),t.TgZ(16,"h4")(17,"strong"),t._uU(18,"\u0627\u0644\u0643\u0645\u064a\u0629 :"),t.qZA(),t._uU(19),t.qZA(),t.TgZ(20,"h4")(21,"strong"),t._uU(22,"\u0645\u0644\u062d\u0648\u0638\u0627\u062a :"),t.qZA(),t._uU(23),t.qZA()(),t.TgZ(24,"div",3)(25,"button",4),t.NdJ("click",function(){return a.confirmDelete()}),t._uU(26),t.qZA(),t.TgZ(27,"button",5),t.NdJ("click",function(){return a.onNoClick()}),t._uU(28,"\u0625\u0644\u063a\u0627\u0621"),t.qZA()()()),2&e&&(t.xp6(7),t.hij(" ",a.data.id,""),t.xp6(4),t.Oqu(a.data.material),t.xp6(4),t.Oqu(a.data.status),t.xp6(4),t.Oqu(a.data.quantity),t.xp6(4),t.Oqu(a.data.comment),t.xp6(3),t.Oqu(a.isSubmitting?"\u0627\u0646\u062a\u0638\u0631 \u0645\u0646 \u0641\u0636\u0644\u0643":"\u062d\u0630\u0641"))},dependencies:[u.uh,u.xY,u.H8,y.lW],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]});var R=n(208),C=n(9549),w=n(4144),J=n(4385),E=n(3238);function z(i,e){if(1&i&&(t.TgZ(0,"mat-option",16),t._uU(1),t.qZA()),2&i){const a=e.$implicit;t.Q6J("value",a.id),t.xp6(1),t.Oqu(a.name)}}function P(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," \u064a\u062c\u0628 \u0627\u062e\u062a\u064a\u0627\u0631 \u0627\u0644\u062e\u0627\u0645\u0629"),t.qZA())}class h{constructor(e,a,o,l,x,at){this.dialogRef=e,this.data=a,this._matTracking=o,this._mat=l,this.fb=x,this.toastr=at,this.subscriptions=[],this.isSubmitting=!1,this.MaterialDataSource=[],this.getAllMaterial=()=>this.subscriptions.push(this._mat.getAll().subscribe({next:p=>{this.MaterialDataSource=p},error:p=>{this.toastr.error((p.error??p).message)},complete:()=>{this.data&&this.form.patchValue(this.data)}})),this.ngOnDestroy=()=>this.subscriptions.forEach(p=>p.unsubscribe()),this.form=this.fb.group({materialId:[null,[s.kI.required]],status:[null],quantity:[0],comment:[""]})}get quantity(){return this.form.get("quantity")}get materialId(){return this.form.get("materialId")}get status(){return this.form.get("status")}ngOnInit(){this.getAllMaterial()}onNoClick(){this.dialogRef.close()}handleSubmit(){this.form.valid&&(this.isSubmitting=!0,this.status.setValue(this.quantity.value>0?d.\u0648\u0627\u0631\u062f:d.\u0635\u0627\u062f\u0631),this.add())}add(){this.subscriptions.push(this._matTracking.add(this.form.value).subscribe({next:e=>{this._matTracking.dialogData=e.body,this.dialogRef.close({data:e})},error:e=>{this.isSubmitting=!1,this.toastr.error((e.error??e).message)},complete:()=>{this.isSubmitting=!1}}))}}h.\u0275fac=function(e){return new(e||h)(t.Y36(u.so),t.Y36(u.WI),t.Y36(c),t.Y36(R.U),t.Y36(s.qu),t.Y36(D._W))},h.\u0275cmp=t.Xpm({type:h,selectors:[["app-form",8,"dialog"]],attrs:["class","dialog"],decls:29,vars:5,consts:[[1,"container"],["mat-dialog-title",""],[1,"d-flex","flex-column","mat-dialog-content",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-9"],["appearance","fill",1,"w-100"],["formControlName","materialId"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"col-3"],["type","number","matInput","","formControlName","quantity"],[1,"col"],["type","text","matInput","","formControlName","comment"],["mat-dialog-actions",""],["mat-raised-button","","type","submit","color","primary",1,"mx-2","px-4",3,"disabled"],["type","button","mat-stroked-button","","color","warn","tabindex","-1",3,"click"],[3,"value"]],template:function(e,a){1&e&&(t.TgZ(0,"div",0)(1,"h2",1),t._uU(2,"\u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u062e\u0627\u0645\u0627\u062a \u0627\u0644\u0648\u0627\u0631\u062f\u0629"),t.qZA(),t.TgZ(3,"mat-dialog-content")(4,"form",2),t.NdJ("ngSubmit",function(){return a.handleSubmit()}),t.TgZ(5,"div",3)(6,"div",4)(7,"mat-form-field",5)(8,"mat-label"),t._uU(9,"\u0627\u0644\u062e\u0627\u0645\u0629"),t.qZA(),t.TgZ(10,"mat-select",6),t.YNc(11,z,2,2,"mat-option",7),t.qZA(),t.YNc(12,P,2,0,"mat-error",8),t.qZA()(),t.TgZ(13,"div",9)(14,"mat-form-field",5)(15,"mat-label"),t._uU(16,"\u0627\u0644\u0643\u0645\u064a\u0629"),t.qZA(),t._UZ(17,"input",10),t.qZA()()(),t.TgZ(18,"div",3)(19,"div",11)(20,"mat-form-field",5)(21,"mat-label"),t._uU(22,"\u0645\u0644\u0627\u062d\u0638\u0627\u062a"),t.qZA(),t._UZ(23,"input",12),t.qZA()()(),t.TgZ(24,"div",13)(25,"button",14),t._uU(26),t.qZA(),t.TgZ(27,"button",15),t.NdJ("click",function(){return a.onNoClick()}),t._uU(28,"\u0625\u0644\u063a\u0627\u0621"),t.qZA()()()()()),2&e&&(t.xp6(4),t.Q6J("formGroup",a.form),t.xp6(7),t.Q6J("ngForOf",a.MaterialDataSource),t.xp6(1),t.Q6J("ngIf",a.materialId.hasError("required")&&(a.materialId.touched||a.materialId.dirty)),t.xp6(13),t.Q6J("disabled",!a.form.valid||a.isSubmitting),t.xp6(1),t.Oqu(a.isSubmitting?"\u0627\u0646\u062a\u0638\u0631 \u0645\u0646 \u0641\u0636\u0644\u0643":"\u062d\u0641\u0638"))},dependencies:[m.sg,m.O5,s._Y,s.Fj,s.wV,s.JJ,s.JL,s.sg,s.u,u.uh,u.xY,u.H8,C.KE,C.hX,C.TO,w.Nt,J.gD,E.ey,y.lW],styles:[".container[_ngcontent-%COMP%]{min-width:450px}"]});var G=n(7392),r=n(671);const H=["filter"];function W(i,e){if(1&i){const a=t.EpF();t.TgZ(0,"button",17),t.NdJ("click",function(){t.CHM(a);const l=t.oxw();return t.KtG(l.clearFilter())}),t.TgZ(1,"mat-icon"),t._uU(2,"close"),t.qZA()()}}function B(i,e){if(1&i&&(t.TgZ(0,"th",20),t._uU(1),t.qZA()),2&i){const a=t.oxw().$implicit;t.xp6(1),t.Oqu(a.header)}}function X(i,e){if(1&i&&(t.TgZ(0,"td",21),t._uU(1),t.ALo(2,"date"),t.qZA()),2&i){const a=e.$implicit,o=t.oxw().$implicit;t.xp6(1),t.Oqu(o.columnDef.indexOf("time")>=0?t.xi3(2,1,o.cell(a),"dd/MM/yyyy || hh:mm a"):o.cell(a))}}function L(i,e){if(1&i&&(t.ynx(0,18),t.YNc(1,B,2,1,"th",19),t.YNc(2,X,3,4,"td",11),t.BQk()),2&i){const o=e.first;t.Q6J("matColumnDef",e.$implicit.columnDef)("sticky",o)}}function j(i,e){if(1&i){const a=t.EpF();t.TgZ(0,"th",22)(1,"button",23),t.NdJ("click",function(){t.CHM(a);const l=t.oxw();return t.KtG(l.addNew())}),t.TgZ(2,"mat-icon",24),t._uU(3,"add"),t.qZA()()()}}function K(i,e){1&i&&t._UZ(0,"td",21)}function $(i,e){1&i&&t._UZ(0,"tr",25)}function V(i,e){1&i&&t._UZ(0,"tr",26)}function tt(i,e){if(1&i&&(t.TgZ(0,"tr",27)(1,"td",28)(2,"div",29)(3,"h3"),t._uU(4,'No data"'),t.qZA()()()()),2&i){const a=t.oxw();t.xp6(1),t.Q6J("colSpan",a.displayedColumns.length)}}class v{constructor(e,a,o,l){this.httpClient=e,this.dialog=a,this._mat=o,this.toastr=l,this.subscriptions=[],this.paginationSizes=[10,20,50,100],this.tableColumns=[],this.clearFilter=()=>this.dataSource.filter=this.filter.nativeElement.value="",this.refreshTable=()=>this.paginator._changePageSize(this.paginator.pageSize),this.ngOnDestroy=()=>this.subscriptions.forEach(x=>x.unsubscribe())}ngOnInit(){this.tableColumns=[{columnDef:"id",header:"#",cell:e=>e.id},{columnDef:"material",header:"\u0623\u0633\u0645 \u0627\u0644\u062e\u0627\u0645\u0629",cell:e=>e.material},{columnDef:"quantity",header:"\u0627\u0644\u0643\u0645\u064a\u0629",cell:e=>e.quantity},{columnDef:"status",header:"\u0627\u0644\u062d\u0627\u0644\u0629",cell:e=>e.status==d.\u0635\u0627\u062f\u0631?"\u0635\u0627\u062f\u0631":"\u0648\u0627\u0631\u062f"},{columnDef:"comment",header:"\u0645\u0644\u0627\u062d\u0638\u0627\u062a",cell:e=>e.comment},{columnDef:"createdBy",header:"\u0627\u0644\u062a\u0633\u062c\u064a\u0644 \u0628\u0648\u0627\u0633\u0637\u0629",cell:e=>e.createdBy},{columnDef:"time-createdOn",header:"\u0648\u0642\u062a \u0627\u0644\u062a\u0633\u062c\u064a\u0644",cell:e=>e.createdOn}],this.displayedColumns=[...this.tableColumns.map(e=>e.columnDef),"actions"],this.loadData()}loadData(){this.database=new c(this.httpClient,this.toastr),this.database.getAllMaterialTracking(),this.dataSource=new Y.G(this.database,this.paginator,this.sort),this.subscriptions.push((0,k.R)(this.filter.nativeElement,"keyup").subscribe(()=>{this.dataSource&&(this.dataSource.filter=this.filter.nativeElement.value)}))}addNew(){const e=this.dialog.open(h,{minWidth:"30%"});this.subscriptions.push(e.afterClosed().subscribe(a=>{a?.data&&(this.database.dataChange.value.push(this._mat.DialogData),this.refreshTable(),this.toastr.success(a.data.message))}))}startEdit(e){const a=this.dialog.open(h,{data:e});this.subscriptions.push(a.afterClosed().subscribe(o=>{o?.data&&(this.database.dataChange.value[this.database.dataChange.value.findIndex(l=>l.id===e.id)]=this._mat.DialogData,this.refreshTable(),this.toastr.success(o.data.message))}))}deleteItem(e){const a=this.dialog.open(b,{data:e,minWidth:"30%"});this.subscriptions.push(a.afterClosed().subscribe(o=>{o?.data&&(this.database.dataChange.value.splice(this.database.dataChange.value.findIndex(l=>l.id===e.id),1),this.refreshTable(),this.toastr.success(o.data.message))}))}}v.\u0275fac=function(e){return new(e||v)(t.Y36(O.eN),t.Y36(u.uw),t.Y36(c),t.Y36(D._W))},v.\u0275cmp=t.Xpm({type:v,selectors:[["app-all"]],viewQuery:function(e,a){if(1&e&&(t.Gf(U.NW,7),t.Gf(Z.YE,7),t.Gf(H,7)),2&e){let o;t.iGM(o=t.CRH())&&(a.paginator=o.first),t.iGM(o=t.CRH())&&(a.sort=o.first),t.iGM(o=t.CRH())&&(a.filter=o.first)}},inputs:{paginationSizes:"paginationSizes"},decls:17,vars:9,consts:[[1,"mx-5","mt-4","mat-elevation-z2"],["floatPlaceholder","never","color","primary",1,"w-100",2,"background-color","white"],["matInput","","placeholder","Filter"],["filter",""],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],["tabindex","0",1,"example-container","mat-elevation-z2","mx-5",2,"background-color","white"],["mat-table","","matSort","","matSortActive","id","matSortDirection","desc","recycleRows","",3,"dataSource"],["table",""],[3,"matColumnDef","sticky",4,"ngFor","ngForOf"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",1,"mx-5","paginator-bottom","mat-elevation-z2",3,"length","pageIndex","pageSizeOptions"],["paginator",""],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],[3,"matColumnDef","sticky"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-icon-button","","color","primary",3,"click"],["aria-label","new item"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],[1,"mat-cell","text-center",3,"colSpan"],[1,"h-100"]],template:function(e,a){if(1&e&&(t.TgZ(0,"div",0)(1,"mat-form-field",1),t._UZ(2,"input",2,3),t.YNc(4,W,3,0,"button",4),t.qZA()(),t.TgZ(5,"section",5)(6,"table",6,7),t.YNc(8,L,3,2,"ng-container",8),t.ynx(9,9),t.YNc(10,j,4,0,"th",10),t.YNc(11,K,1,0,"td",11),t.BQk(),t.YNc(12,$,1,0,"tr",12),t.YNc(13,V,1,0,"tr",13),t.YNc(14,tt,5,1,"tr",14),t.qZA()(),t._UZ(15,"mat-paginator",15,16)),2&e){const o=t.MAs(3);t.xp6(4),t.Q6J("ngIf",o.value),t.xp6(2),t.Q6J("dataSource",a.dataSource),t.xp6(2),t.Q6J("ngForOf",a.tableColumns),t.xp6(4),t.Q6J("matHeaderRowDef",a.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",a.displayedColumns),t.xp6(2),t.Q6J("length",a.dataSource.filteredData.length)("pageIndex",0)("pageSizeOptions",a.paginationSizes)}},dependencies:[m.sg,m.O5,C.KE,C.R9,G.Hw,w.Nt,U.NW,r.BZ,r.AE,r.fO,r.as,r.w1,r.Dz,r.nj,r.ge,r.ev,r.XQ,r.Gk,r.Ee,Z.YE,Z.nU,y.RK,m.uU],styles:[".example-container[_ngcontent-%COMP%]{min-height:70vh;max-height:70vh;overflow:auto}table[_ngcontent-%COMP%]{height:100%;width:100%;min-width:100%}table[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:#3f51b5}.mat-column-id[_ngcontent-%COMP%]{width:100px;text-align:left}.mat-column-actions[_ngcontent-%COMP%]{width:150px;text-align:right}.mat-mdc-header-cell[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;white-space:nowrap;min-width:100px}.mat-mdc-row[_ngcontent-%COMP%]{white-space:nowrap}.mat-mdc-row[_ngcontent-%COMP%]:hover   .mat-mdc-cell[_ngcontent-%COMP%]{border-color:#ff4500;background-color:#ffdbdb}.paginator-bottom[_ngcontent-%COMP%]{width:auto;position:fixed;bottom:2rem;left:0;right:0}"]});class A{}A.\u0275fac=function(e){return new(e||A)},A.\u0275cmp=t.Xpm({type:A,selectors:[["app-materialTracking"]],decls:1,vars:0,template:function(e,a){1&e&&t._UZ(0,"router-outlet")},dependencies:[T.lC]});const et=[{path:"",component:A,title:"\u0623\u0633\u062a\u0647\u0644\u0627\u0643 \u0627\u0644\u062e\u0627\u0645\u0627\u062a",canActivateChild:[S.i],children:[{path:"all",component:v,title:"\u0623\u0633\u062a\u0647\u0644\u0627\u0643 \u0627\u0644\u062e\u0627\u0645\u0627\u062a"},{path:"",redirectTo:"all",pathMatch:"full"}]}];class g{}g.\u0275fac=function(e){return new(e||g)},g.\u0275mod=t.oAB({type:g}),g.\u0275inj=t.cJS({imports:[T.Bz.forChild(et),T.Bz]});class f{}f.\u0275fac=function(e){return new(e||f)},f.\u0275mod=t.oAB({type:f}),f.\u0275inj=t.cJS({providers:[S.i,m.uU],imports:[m.ez,g,s.u5,s.UX,m.ez,N.SharedModule,F.I]})}}]);